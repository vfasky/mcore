!function(){"use strict";var t="0.8.1",e=1;if(!Object.create)var i=function(){};var n=Array.prototype.slice,r={attributes:{},eventHandlers:{"-1":{}},guid:-1,addEvent:function(t){r.eventHandlers[t.guid][t.type]||(r.eventHandlers[t.guid][t.type]=[]),r.eventHandlers[t.guid][t.type].push({guid:t.guid,handler:t.handler,scope:t.scope,type:t.type})},addEventHandler:function(t,e,i){var n,o={};"string"==typeof t?(n=i||!1,o[t]=e):(n=e||!1,o=t);for(var s in o)for(var a=o[s],l=s.split(" "),u=0,c=l.length;c>u;u++){var h=l[u];r.addEvent.call(this,{guid:this._guid||this._.guid,handler:a,scope:n,type:h})}},addGuid:function(t,i){(!t._guid||i)&&(t._guid=e++,r.attributes[t._guid]={},r.eventHandlers[t._guid]={})},attr:function(t){return r.attributes[t]},clone:function(t){var e=r.typeOf(t);return"object"===e?r.extend({},t):"array"===e?t.slice(0):void 0},create:function(t){return Object.create?Object.create(t):(i.prototype=t,new i)},createSubclass:function(t,e){function i(){if(!(this instanceof i))throw new Error("Please use 'new' when initializing Stapes classes");this.on&&r.addGuid(this,!0),s.apply(this,arguments)}t=t||{},e=e||!1;var n=t.superclass.prototype,s=t.hasOwnProperty("constructor")?t.constructor:function(){};e&&r.extend(n,o),i.prototype=r.create(n),i.prototype.constructor=i,r.extend(i,{extend:function(){return r.extendThis.apply(this,arguments)},parent:n,proto:function(){return r.extendThis.apply(this.prototype,arguments)},subclass:function(t){return t=t||{},t.superclass=this,r.createSubclass(t)}});for(var a in t)"constructor"!==a&&"superclass"!==a&&(i.prototype[a]=t[a]);return i},emitEvents:function(t,e,i,o){i=i||!1,o=o||this._guid;for(var s=n.call(r.eventHandlers[o][t]),a=0,l=s.length;l>a;a++){var u=r.extend({},s[a]),c=u.scope?u.scope:this;i&&(u.type=i),u.scope=c,u.handler.call(u.scope,e,u)}},extend:function(){for(var t=n.call(arguments),e=t.shift(),i=0,r=t.length;r>i;i++){var o=t[i];for(var s in o)e[s]=o[s]}return e},extendThis:function(){var t=n.call(arguments);return t.unshift(this),r.extend.apply(this,t)},makeUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})},removeAttribute:function(t,e){e=e||!1;for(var i=r.trim(t).split(" "),n={},o=0,s=i.length;s>o;o++){var a=r.trim(i[o]);a&&(n.key=a,n.oldValue=r.attr(this._guid)[a],delete r.attr(this._guid)[a],e||(this.emit("change",a),this.emit("change:"+a),this.emit("mutate",n),this.emit("mutate:"+a,n),this.emit("remove",a),this.emit("remove:"+a)),delete n.oldValue)}},removeEventHandler:function(t,e){var i=r.eventHandlers[this._guid];if(t&&e){if(i=i[t],!i)return;for(var n,o=0,s=i.length;s>o;o++)n=i[o].handler,n&&n===e&&(i.splice(o--,1),s--)}else t?delete i[t]:r.eventHandlers[this._guid]={}},setAttribute:function(t,e,i){i=i||!1;var n=this.has(t),o=r.attr(this._guid)[t];if(e!==o&&(r.attr(this._guid)[t]=e,!i)){this.emit("change",t),this.emit("change:"+t,e);var s={key:t,newValue:e,oldValue:o||null};this.emit("mutate",s),this.emit("mutate:"+t,s);var a=n?"update":"create";this.emit(a,t),this.emit(a+":"+t,e)}},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},typeOf:function(t){return null===t||"undefined"==typeof t?String(t):Object.prototype.toString.call(t).replace(/\[object |\]/g,"").toLowerCase()},updateAttribute:function(t,e,i){var n=this.get(t),o=r.typeOf(n);("object"===o||"array"===o)&&(n=r.clone(n));var s=e.call(this,n,t);r.setAttribute.call(this,t,s,i||!1)}},o={emit:function(t,e){e="undefined"==typeof e?null:e;for(var i=t.split(" "),n=0,o=i.length;o>n;n++){var s=i[n];r.eventHandlers[-1].all&&r.emitEvents.call(this,"all",e,s,-1),r.eventHandlers[-1][s]&&r.emitEvents.call(this,s,e,s,-1),"number"==typeof this._guid&&(r.eventHandlers[this._guid].all&&r.emitEvents.call(this,"all",e,s),r.eventHandlers[this._guid][s]&&r.emitEvents.call(this,s,e))}},off:function(){r.removeEventHandler.apply(this,arguments)},on:function(){r.addEventHandler.apply(this,arguments)}};r.Module=function(){},r.Module.prototype={each:function(t,e){var i=r.attr(this._guid);for(var n in i){var o=i[n];t.call(e||this,o,n)}},extend:function(){return r.extendThis.apply(this,arguments)},filter:function(t){var e=[],i=r.attr(this._guid);for(var n in i)t.call(this,i[n],n)&&e.push(i[n]);return e},get:function(t){if("string"==typeof t){if(arguments.length>1){for(var e={},i=0,n=arguments.length;n>i;i++){var o=arguments[i];e[o]=this.get(o)}return e}return this.has(t)?r.attr(this._guid)[t]:null}if("function"==typeof t){var s=this.filter(t);return s.length?s[0]:null}},getAll:function(){return r.clone(r.attr(this._guid))},getAllAsArray:function(){var t=[],e=r.attr(this._guid);for(var i in e){var n=e[i];"object"!==r.typeOf(n)||n.id||(n.id=i),t.push(n)}return t},has:function(t){return"undefined"!=typeof r.attr(this._guid)[t]},map:function(t,e){var i=[];return this.each(function(n,r){i.push(t.call(e||this,n,r))},e||this),i},push:function(t,e){if("array"===r.typeOf(t))for(var i=0,n=t.length;n>i;i++)r.setAttribute.call(this,r.makeUuid(),t[i],e||!1);else r.setAttribute.call(this,r.makeUuid(),t,e||!1);return this},remove:function(t,e){return"undefined"==typeof t?(r.attributes[this._guid]={},this.emit("change remove")):"function"==typeof t?this.each(function(i,n){t(i)&&r.removeAttribute.call(this,n,e)}):r.removeAttribute.call(this,t,e||!1),this},set:function(t,e,i){if("object"==typeof t)for(var n in t)r.setAttribute.call(this,n,t[n],e||!1);else r.setAttribute.call(this,t,e,i||!1);return this},size:function(){var t=0,e=r.attr(this._guid);for(var i in e)t++;return t},update:function(t,e,i){return"string"==typeof t?r.updateAttribute.call(this,t,e,i||!1):"function"==typeof t&&this.each(function(e,i){r.updateAttribute.call(this,i,t)}),this}};var s={_:r,extend:function(){return r.extendThis.apply(r.Module.prototype,arguments)},mixinEvents:function(t){return t=t||{},r.addGuid(t),r.extend(t,o)},on:function(){r.addEventHandler.apply(this,arguments)},subclass:function(t,e){return e=e||!1,t=t||{},t.superclass=e?function(){}:r.Module,r.createSubclass(t,!e)},version:t};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports.Stapes=s):"function"==typeof define&&define.amd?define("stapes",function(){return s}):window.Stapes=s}(),function(){function t(t,i,n,r){return new e(t,i,n,r)}function e(t,e,n,r){this.options=r||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=n,this.objectPath=[],this.parse(),i(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function i(t){return"object"==typeof t&&null!==t}function n(t){throw new Error("[sightglass] "+t)}t.adapters={},e.tokenize=function(t,e,i){var n,r,o=[],s={i:i,path:""};for(n=0;n<t.length;n++)r=t.charAt(n),~e.indexOf(r)?(o.push(s),s={i:r,path:""}):s.path+=r;return o.push(s),o},e.prototype.parse=function(){var i,r,o=this.interfaces();o.length||n("Must define at least one adapter interface."),~o.indexOf(this.keypath[0])?(i=this.keypath[0],r=this.keypath.substr(1)):("undefined"==typeof(i=this.options.root||t.root)&&n("Must define a default root adapter."),r=this.keypath),this.tokens=e.tokenize(r,o,i),this.key=this.tokens.pop()},e.prototype.realize=function(){var t,e=this.obj,n=!1;return this.tokens.forEach(function(r,o){i(e)?("undefined"!=typeof this.objectPath[o]?e!==(t=this.objectPath[o])&&(this.set(!1,r,t,this.update.bind(this)),this.set(!0,r,e,this.update.bind(this)),this.objectPath[o]=e):(this.set(!0,r,e,this.update.bind(this)),this.objectPath[o]=e),e=this.get(r,e)):(n===!1&&(n=o),(t=this.objectPath[o])&&this.set(!1,r,t,this.update.bind(this)))},this),n!==!1&&this.objectPath.splice(n),e},e.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(i(this.target)&&this.set(!1,this.key,this.target,this.callback),i(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,this.value()!==e&&this.callback())},e.prototype.value=function(){return i(this.target)?this.get(this.key,this.target):void 0},e.prototype.setValue=function(t){i(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},e.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},e.prototype.set=function(t,e,i,n){var r=t?"observe":"unobserve";this.adapter(e)[r](i,e.path,n)},e.prototype.interfaces=function(){var e=Object.keys(this.options.adapters);return Object.keys(t.adapters).forEach(function(t){~e.indexOf(t)||e.push(t)}),e},e.prototype.adapter=function(e){return this.options.adapters[e.i]||t.adapters[e.i]},e.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,i){(t=this.objectPath[i])&&this.set(!1,e,t,this.update.bind(this))},this),i(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define("sightglass",[],function(){return this.sightglass=t}):this.sightglass=t}.call(this),function(){var t,e,i,n,r=function(t,e){return function(){return t.apply(e,arguments)}},o=[].slice,s={}.hasOwnProperty,a=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};t={options:["prefix","templateDelimiters","rootInterface","preloadData","handler"],extensions:["binders","formatters","components","adapters"],"public":{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,handler:function(t,e,i){return this.call(t,e,i.view.models)},configure:function(e){var i,n,r,o;null==e&&(e={});for(r in e)if(o=e[r],"binders"===r||"components"===r||"formatters"===r||"adapters"===r)for(n in o)i=o[n],t[r][n]=i;else t["public"][r]=o},bind:function(e,i,n){var r;return null==i&&(i={}),null==n&&(n={}),r=new t.View(e,i,n),r.bind(),r},init:function(e,i,n){var r,o;return null==n&&(n={}),null==i&&(i=document.createElement("div")),e=t["public"].components[e],i.innerHTML=e.template.call(this,i),r=e.initialize.call(this,i,n),o=new t.View(i,r),o.bind(),o}}},window.jQuery||window.$?(n="on"in jQuery.prototype?["on","off"]:["bind","unbind"],e=n[0],i=n[1],t.Util={bindEvent:function(t,i,n){return jQuery(t)[e](i,n)},unbindEvent:function(t,e,n){return jQuery(t)[i](e,n)},getInputValue:function(t){var e;return e=jQuery(t),"checkbox"===e.attr("type")?e.is(":checked"):e.val()}}):t.Util={bindEvent:function(){return"addEventListener"in window?function(t,e,i){return t.addEventListener(e,i,!1)}:function(t,e,i){return t.attachEvent("on"+e,i)}}(),unbindEvent:function(){return"removeEventListener"in window?function(t,e,i){return t.removeEventListener(e,i,!1)}:function(t,e,i){return t.detachEvent("on"+e,i)}}(),getInputValue:function(t){var e,i,n,r;if("checkbox"===t.type)return t.checked;if("select-multiple"===t.type){for(r=[],i=0,n=t.length;n>i;i++)e=t[i],e.selected&&r.push(e.value);return r}return t.value}},t.TypeParser=function(){function t(){}return t.types={primitive:0,keypath:1},t.parse=function(t){return/^'.*'$|^".*"$/.test(t)?{type:this.types.primitive,value:t.slice(1,-1)}:"true"===t?{type:this.types.primitive,value:!0}:"false"===t?{type:this.types.primitive,value:!1}:"null"===t?{type:this.types.primitive,value:null}:"undefined"===t?{type:this.types.primitive,value:void 0}:isNaN(Number(t))===!1?{type:this.types.primitive,value:Number(t)}:{type:this.types.keypath,value:t}},t}(),t.TextTemplateParser=function(){function t(){}return t.types={text:0,binding:1},t.parse=function(t,e){var i,n,r,o,s,a,l;for(a=[],o=t.length,i=0,n=0;o>n;){if(i=t.indexOf(e[0],n),0>i){a.push({type:this.types.text,value:t.slice(n)});break}if(i>0&&i>n&&a.push({type:this.types.text,value:t.slice(n,i)}),n=i+e[0].length,i=t.indexOf(e[1],n),0>i){s=t.slice(n-e[1].length),r=a[a.length-1],(null!=r?r.type:void 0)===this.types.text?r.value+=s:a.push({type:this.types.text,value:s});break}l=t.slice(n,i).trim(),a.push({type:this.types.binding,value:l}),n=i+e[1].length}return a},t}(),t.View=function(){function e(e,i,n){var o,s,a,l,u,c,h,p,f,d,_,m,v;for(this.els=e,this.models=i,null==n&&(n={}),this.update=r(this.update,this),this.publish=r(this.publish,this),this.sync=r(this.sync,this),this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.select=r(this.select,this),this.traverse=r(this.traverse,this),this.build=r(this.build,this),this.buildBinding=r(this.buildBinding,this),this.bindingRegExp=r(this.bindingRegExp,this),this.options=r(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),f=t.extensions,u=0,h=f.length;h>u;u++){if(s=f[u],this[s]={},n[s]){d=n[s];for(o in d)a=d[o],this[s][o]=a}_=t["public"][s];for(o in _)a=_[o],null==(l=this[s])[o]&&(l[o]=a)}for(m=t.options,c=0,p=m.length;p>c;c++)s=m[c],this[s]=null!=(v=n[s])?v:t["public"][s];this.build()}return e.prototype.options=function(){var e,i,n,r,o;for(i={},o=t.extensions.concat(t.options),n=0,r=o.length;r>n;n++)e=o[n],i[e]=this[e];return i},e.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},e.prototype.buildBinding=function(e,i,n,r){var o,s,a,l,u,c,h;return u={},h=function(){var t,e,i,n;for(i=r.split("|"),n=[],t=0,e=i.length;e>t;t++)c=i[t],n.push(c.trim());return n}(),o=function(){var t,e,i,n;for(i=h.shift().split("<"),n=[],t=0,e=i.length;e>t;t++)s=i[t],n.push(s.trim());return n}(),l=o.shift(),u.formatters=h,(a=o.shift())&&(u.dependencies=a.split(/\s+/)),this.bindings.push(new t[e](this,i,n,l,u))},e.prototype.build=function(){var e,i,n,r,o;for(this.bindings=[],i=function(e){return function(n){var r,o,s,a,l,u,c,h,p,f,d,_,m,v;if(3===n.nodeType){if(l=t.TextTemplateParser,(s=e.templateDelimiters)&&(h=l.parse(n.data,s)).length&&(1!==h.length||h[0].type!==l.types.text)){for(p=0,d=h.length;d>p;p++)c=h[p],u=document.createTextNode(c.value),n.parentNode.insertBefore(u,n),1===c.type&&e.buildBinding("TextBinding",u,null,c.value);n.parentNode.removeChild(n)}}else 1===n.nodeType&&(r=e.traverse(n));if(!r){for(m=function(){var t,e,i,r;for(i=n.childNodes,r=[],t=0,e=i.length;e>t;t++)a=i[t],r.push(a);return r}(),v=[],f=0,_=m.length;_>f;f++)o=m[f],v.push(i(o));return v}}}(this),o=this.els,n=0,r=o.length;r>n;n++)e=o[n],i(e);this.bindings.sort(function(t,e){var i,n;return((null!=(i=e.binder)?i.priority:void 0)||0)-((null!=(n=t.binder)?n.priority:void 0)||0)})},e.prototype.traverse=function(e){var i,n,r,o,s,a,l,u,c,h,p,f,d,_,m,v;for(o=this.bindingRegExp(),s="SCRIPT"===e.nodeName||"STYLE"===e.nodeName,_=e.attributes,h=0,f=_.length;f>h;h++)if(i=_[h],o.test(i.name)){if(u=i.name.replace(o,""),!(r=this.binders[u])){m=this.binders;for(a in m)c=m[a],"*"!==a&&-1!==a.indexOf("*")&&(l=new RegExp("^"+a.replace(/\*/g,".+")+"$"),l.test(u)&&(r=c))}r||(r=this.binders["*"]),r.block&&(s=!0,n=[i])}for(v=n||e.attributes,p=0,d=v.length;d>p;p++)i=v[p],o.test(i.name)&&(u=i.name.replace(o,""),this.buildBinding("Binding",e,u,i.value));return s||(u=e.nodeName.toLowerCase(),this.components[u]&&!e._bound&&(this.bindings.push(new t.ComponentBinding(this,e,u)),s=!0)),s},e.prototype.select=function(t){var e,i,n,r,o;for(r=this.bindings,o=[],i=0,n=r.length;n>i;i++)e=r[i],t(e)&&o.push(e);return o},e.prototype.bind=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.bind());return r},e.prototype.unbind=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.unbind());return r},e.prototype.sync=function(){var t,e,i,n,r;for(n=this.bindings,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push("function"==typeof t.sync?t.sync():void 0);return r},e.prototype.publish=function(){var t,e,i,n,r;for(n=this.select(function(t){var e;return null!=(e=t.binder)?e.publishes:void 0}),r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(t.publish());return r},e.prototype.update=function(t){var e,i,n,r,o,s,a;null==t&&(t={});for(i in t)n=t[i],this.models[i]=n;for(s=this.bindings,a=[],r=0,o=s.length;o>r;r++)e=s[r],a.push("function"==typeof e.update?e.update(t):void 0);return a},e}(),t.Binding=function(){function e(t,e,i,n,o){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=o?o:{},this.getValue=r(this.getValue,this),this.update=r(this.update,this),this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.publish=r(this.publish,this),this.sync=r(this.sync,this),this.set=r(this.set,this),this.eventHandler=r(this.eventHandler,this),this.formattedValue=r(this.formattedValue,this),this.parseTarget=r(this.parseTarget,this),this.observe=r(this.observe,this),this.setBinder=r(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return e.prototype.setBinder=function(){var t,e,i,n;if(!(this.binder=this.view.binders[this.type])){n=this.view.binders;for(t in n)i=n[t],"*"!==t&&-1!==t.indexOf("*")&&(e=new RegExp("^"+t.replace(/\*/g,".+")+"$"),e.test(this.type)&&(this.binder=i,this.args=new RegExp("^"+t.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}return this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function?this.binder={routine:this.binder}:void 0},e.prototype.observe=function(e,i,n){return t.sightglass(e,i,n,{root:this.view.rootInterface,adapters:this.view.adapters})},e.prototype.parseTarget=function(){var e;return e=t.TypeParser.parse(this.keypath),0===e.type?this.value=e.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},e.prototype.formattedValue=function(e){var i,n,r,s,a,l,u,c,h,p,f,d,_,m;for(m=this.formatters,s=p=0,d=m.length;d>p;s=++p){for(a=m[s],r=a.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),l=r.shift(),a=this.view.formatters[l],r=function(){var e,i,o;for(o=[],e=0,i=r.length;i>e;e++)n=r[e],o.push(t.TypeParser.parse(n));return o}(),c=[],i=f=0,_=r.length;_>f;i=++f)n=r[i],c.push(0===n.type?n.value:((h=this.formatterObservers)[s]||(h[s]={}),(u=this.formatterObservers[s][i])?void 0:(u=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[s][i]=u),u.value()));(null!=a?a.read:void 0)instanceof Function?e=a.read.apply(a,[e].concat(o.call(c))):a instanceof Function&&(e=a.apply(null,[e].concat(o.call(c))))}return e},e.prototype.eventHandler=function(t){var e,i;return i=(e=this).view.handler,function(n){return i.call(t,this,n,e)}},e.prototype.set=function(t){var e;return t=t instanceof Function&&!this.binder["function"]?this.formattedValue(t.call(this.model)):this.formattedValue(t),null!=(e=this.binder.routine)?e.call(this,this.el,t):void 0},e.prototype.sync=function(){var t,e;return this.set(function(){var i,n,r,o,s,a,l;if(this.observer){if(this.model!==this.observer.target){for(s=this.dependencies,i=0,r=s.length;r>i;i++)e=s[i],e.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(a=this.options.dependencies)?a.length:void 0))for(l=this.options.dependencies,n=0,o=l.length;o>n;n++)t=l[n],e=this.observe(this.model,t,this.sync),this.dependencies.push(e)}return this.observer.value()}return this.value}.call(this))},e.prototype.publish=function(){var t,e,i,n,r,s,a,l,u;if(this.observer){for(n=this.getValue(this.el),a=this.formatters.slice(0).reverse(),r=0,s=a.length;s>r;r++)e=a[r],t=e.split(/\s+/),i=t.shift(),(null!=(l=this.view.formatters[i])?l.publish:void 0)&&(n=(u=this.view.formatters[i]).publish.apply(u,[n].concat(o.call(t))));return this.observer.setValue(n)}},e.prototype.bind=function(){var t,e,i,n,r,o,s;if(this.parseTarget(),null!=(r=this.binder.bind)&&r.call(this,this.el),null!=this.model&&(null!=(o=this.options.dependencies)?o.length:void 0))for(s=this.options.dependencies,i=0,n=s.length;n>i;i++)t=s[i],e=this.observe(this.model,t,this.sync),this.dependencies.push(e);return this.view.preloadData?this.sync():void 0},e.prototype.unbind=function(){var t,e,i,n,r,o,s,a,l,u;for(null!=(s=this.binder.unbind)&&s.call(this,this.el),null!=(a=this.observer)&&a.unobserve(),l=this.dependencies,r=0,o=l.length;o>r;r++)n=l[r],n.unobserve();this.dependencies=[],u=this.formatterObservers;for(i in u){e=u[i];for(t in e)n=e[t],n.unobserve()}return this.formatterObservers={}},e.prototype.update=function(t){var e,i;return null==t&&(t={}),this.model=null!=(e=this.observer)?e.target:void 0,null!=(i=this.binder.update)?i.call(this,t):void 0},e.prototype.getValue=function(e){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,e):t.Util.getInputValue(e)},e}(),t.ComponentBinding=function(e){function i(t,e,i){var n,o,s,a,u,c,h;for(this.view=t,this.el=e,this.type=i,this.unbind=r(this.unbind,this),this.bind=r(this.bind,this),this.locals=r(this.locals,this),this.component=this.view.components[this.type],this["static"]={},this.observers={},this.upstreamObservers={},o=t.bindingRegExp(),c=this.el.attributes||[],a=0,u=c.length;u>a;a++)n=c[a],o.test(n.name)||(s=this.camelCase(n.name),l.call(null!=(h=this.component["static"])?h:[],s)>=0?this["static"][s]=n.value:this.observers[s]=n.value)}return a(i,e),i.prototype.sync=function(){},i.prototype.update=function(){},i.prototype.publish=function(){},i.prototype.locals=function(){var t,e,i,n,r,o;i={},r=this["static"];for(t in r)n=r[t],i[t]=n;o=this.observers;for(t in o)e=o[t],i[t]=e.value();return i},i.prototype.camelCase=function(t){return t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})},i.prototype.bind=function(){var e,i,n,r,o,s,a,l,u,c,h,p,f,d,_,m,v,g,b,y,w;if(!this.bound){d=this.observers;for(i in d)n=d[i],this.observers[i]=this.observe(this.view.models,n,function(t){return function(e){return function(){return t.componentView.models[e]=t.observers[e].value()}}}(this).call(this,i));this.bound=!0}if(null!=this.componentView)return this.componentView.bind();for(this.el.innerHTML=this.component.template.call(this),a=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,s={},_=t.extensions,c=0,p=_.length;p>c;c++){if(o=_[c],s[o]={},this.component[o]){m=this.component[o];for(e in m)l=m[e],s[o][e]=l}v=this.view[o];for(e in v)l=v[e],null==(u=s[o])[e]&&(u[e]=l)}for(g=t.options,h=0,f=g.length;f>h;h++)o=g[h],s[o]=null!=(b=this.component[o])?b:this.view[o];this.componentView=new t.View(this.el,a,s),this.componentView.bind(),y=this.observers,w=[];for(i in y)r=y[i],w.push(this.upstreamObservers[i]=this.observe(this.componentView.models,i,function(t){return function(e,i){return function(){return i.setValue(t.componentView.models[e])}}}(this).call(this,i,r)));return w},i.prototype.unbind=function(){var t,e,i,n,r;i=this.upstreamObservers;for(t in i)e=i[t],e.unobserve();n=this.observers;for(t in n)e=n[t],e.unobserve();return null!=(r=this.componentView)?r.unbind.call(this):void 0},i}(t.Binding),t.TextBinding=function(t){function e(t,e,i,n,o){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=o?o:{},this.sync=r(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return a(e,t),e.prototype.binder={routine:function(t,e){return t.data=null!=e?e:""}},e.prototype.sync=function(){return e.__super__.sync.apply(this,arguments)},e}(t.Binding),t["public"].binders.text=function(t,e){return null!=t.textContent?t.textContent=null!=e?e:"":t.innerText=null!=e?e:""},t["public"].binders.html=function(t,e){return t.innerHTML=null!=e?e:""},t["public"].binders.show=function(t,e){return t.style.display=e?"":"none"},t["public"].binders.hide=function(t,e){return t.style.display=e?"none":""},t["public"].binders.enabled=function(t,e){return t.disabled=!e},t["public"].binders.disabled=function(t,e){return t.disabled=!!e},t["public"].binders.checked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var i;return"radio"===t.type?t.checked=(null!=(i=t.value)?i.toString():void 0)===(null!=e?e.toString():void 0):t.checked=!!e}},t["public"].binders.unchecked={publishes:!0,priority:2e3,bind:function(e){return t.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return t.Util.unbindEvent(e,"change",this.publish)},routine:function(t,e){var i;return"radio"===t.type?t.checked=(null!=(i=t.value)?i.toString():void 0)!==(null!=e?e.toString():void 0):t.checked=!e}},t["public"].binders.value={publishes:!0,priority:3e3,bind:function(e){return"INPUT"!==e.tagName||"radio"!==e.type?(this.event="SELECT"===e.tagName?"change":"input",t.Util.bindEvent(e,this.event,this.publish)):void 0},unbind:function(e){return"INPUT"!==e.tagName||"radio"!==e.type?t.Util.unbindEvent(e,this.event,this.publish):void 0},routine:function(t,e){var i,n,r,o,s,a,u;if("INPUT"===t.tagName&&"radio"===t.type)return t.setAttribute("value",e);if(null!=window.jQuery){if(t=jQuery(t),(null!=e?e.toString():void 0)!==(null!=(o=t.val())?o.toString():void 0))return t.val(null!=e?e:"")}else if("select-multiple"===t.type){if(null!=e){for(u=[],n=0,r=t.length;r>n;n++)i=t[n],u.push(i.selected=(s=i.value,l.call(e,s)>=0));return u}}else if((null!=e?e.toString():void 0)!==(null!=(a=t.value)?a.toString():void 0))return t.value=null!=e?e:""}},t["public"].binders["if"]={block:!0,priority:4e3,bind:function(t){var e,i;return null==this.marker?(e=[this.view.prefix,this.type].join("-").replace("--","-"),i=t.getAttribute(e),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),this.bound=!1,t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t)):void 0},unbind:function(){var t;return null!=(t=this.nested)?t.unbind():void 0},routine:function(e,i){var n,r,o,s;if(!!i==!this.bound){if(i){o={},s=this.view.models;for(n in s)r=s[n],o[n]=r;return(this.nested||(this.nested=new t.View(e,o,this.view.options()))).bind(),this.marker.parentNode.insertBefore(e,this.marker.nextSibling),this.bound=!0}return e.parentNode.removeChild(e),this.nested.unbind(),this.bound=!1}},update:function(t){var e;return null!=(e=this.nested)?e.update(t):void 0}},t["public"].binders.unless={block:!0,priority:4e3,bind:function(e){return t["public"].binders["if"].bind.call(this,e)},unbind:function(){return t["public"].binders["if"].unbind.call(this)},routine:function(e,i){return t["public"].binders["if"].routine.call(this,e,!i)},update:function(e){return t["public"].binders["if"].update.call(this,e)}},t["public"].binders["on-*"]={"function":!0,priority:1e3,unbind:function(e){return this.handler?t.Util.unbindEvent(e,this.args[0],this.handler):void 0},routine:function(e,i){return this.handler&&t.Util.unbindEvent(e,this.args[0],this.handler),t.Util.bindEvent(e,this.args[0],this.handler=this.eventHandler(i))}},t["public"].binders["each-*"]={block:!0,priority:4e3,bind:function(t){var e,i,n,r,o;if(null==this.marker)e=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t);else for(o=this.iterated,n=0,r=o.length;r>n;n++)i=o[n],i.bind()},unbind:function(t){var e,i,n,r,o;if(null!=this.iterated){for(r=this.iterated,o=[],i=0,n=r.length;n>i;i++)e=r[i],o.push(e.unbind());return o}},routine:function(e,i){var n,r,o,s,a,l,u,c,h,p,f,d,_,m,v,g,b,y,w,x,T;if(u=this.args[0],i=i||[],this.iterated.length>i.length)for(y=Array(this.iterated.length-i.length),d=0,v=y.length;v>d;d++)o=y[d],f=this.iterated.pop(),f.unbind(),this.marker.parentNode.removeChild(f.els[0]);for(s=_=0,g=i.length;g>_;s=++_)if(l=i[s],r={index:s},r[u]=l,null==this.iterated[s]){w=this.view.models;for(a in w)l=w[a],null==r[a]&&(r[a]=l);h=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,c=this.view.options(),c.preloadData=!0,p=e.cloneNode(!0),f=new t.View(p,r,c),f.bind(),this.iterated.push(f),this.marker.parentNode.insertBefore(p,h.nextSibling)}else this.iterated[s].models[u]!==l&&this.iterated[s].update(r);if("OPTION"===e.nodeName){for(x=this.view.bindings,T=[],m=0,b=x.length;b>m;m++)n=x[m],n.el===this.marker.parentNode&&"value"===n.type?T.push(n.sync()):T.push(void 0);return T}},update:function(t){var e,i,n,r,o,s,a,l;e={};for(i in t)n=t[i],i!==this.args[0]&&(e[i]=n);for(a=this.iterated,l=[],o=0,s=a.length;s>o;o++)r=a[o],l.push(r.update(e));return l}},t["public"].binders["class-*"]=function(t,e){var i;return i=" "+t.className+" ",!e==(-1!==i.indexOf(" "+this.args[0]+" "))?t.className=e?""+t.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim():void 0},t["public"].binders["*"]=function(t,e){return null!=e?t.setAttribute(this.type,e):t.removeAttribute(this.type)},t["public"].adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(t){var e,i,n;return t.hasOwnProperty(this.id)||(e=this.counter++,Object.defineProperty(t,this.id,{value:e})),(i=this.weakmap)[n=t[this.id]]||(i[n]={callbacks:{}})},cleanupWeakReference:function(t,e){return Object.keys(t.callbacks).length||t.pointers&&Object.keys(t.pointers).length?void 0:delete this.weakmap[e]},stubFunction:function(t,e){var i,n,r;return n=t[e],i=this.weakReference(t),r=this.weakmap,t[e]=function(){var e,o,s,a,l,u,c,h,p,f;a=n.apply(t,arguments),c=i.pointers;for(s in c)for(o=c[s],f=null!=(h=null!=(p=r[s])?p.callbacks[o]:void 0)?h:[],l=0,u=f.length;u>l;l++)(e=f[l])();return a}},observeMutations:function(t,e,i){var n,r,o,s,a,u;if(Array.isArray(t)){if(o=this.weakReference(t),null==o.pointers)for(o.pointers={},r=["push","pop","shift","unshift","sort","reverse","splice"],a=0,u=r.length;u>a;a++)n=r[a],this.stubFunction(t,n);if(null==(s=o.pointers)[e]&&(s[e]=[]),l.call(o.pointers[e],i)<0)return o.pointers[e].push(i)}},unobserveMutations:function(t,e,i){var n,r,o;return Array.isArray(t)&&null!=t[this.id]&&(r=this.weakmap[t[this.id]])&&(o=r.pointers[e])?((n=o.indexOf(i))>=0&&o.splice(n,1),o.length||delete r.pointers[e],this.cleanupWeakReference(r,t[this.id])):void 0},observe:function(t,e,i){var n,r,o;return n=this.weakReference(t).callbacks,null==n[e]&&(n[e]=[],r=Object.getOwnPropertyDescriptor(t,e),(null!=r?r.get:void 0)||(null!=r?r.set:void 0)||(o=t[e],Object.defineProperty(t,e,{enumerable:!0,get:function(){return o},set:function(r){return function(s){var a,u,c,h;if(s!==o&&(r.unobserveMutations(o,t[r.id],e),o=s,a=r.weakmap[t[r.id]])){if(n=a.callbacks,n[e])for(h=n[e].slice(),u=0,c=h.length;c>u;u++)i=h[u],l.call(n[e],i)>=0&&i();return r.observeMutations(s,t[r.id],e)}}}(this)}))),l.call(n[e],i)<0&&n[e].push(i),this.observeMutations(t[e],t[this.id],e)},unobserve:function(t,e,i){var n,r,o;return(o=this.weakmap[t[this.id]])&&(n=o.callbacks[e])?((r=n.indexOf(i))>=0&&(n.splice(r,1),n.length||delete o.callbacks[e]),this.unobserveMutations(t[e],t[this.id],e),this.cleanupWeakReference(o,t[this.id])):void 0},get:function(t,e){return t[e]},set:function(t,e,i){return t[e]=i}},t.factory=function(e){return t.sightglass=e,t["public"]._=t,t["public"]},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=t.factory(require("sightglass")):"function"==typeof define&&define.amd?define("rivets",["sightglass"],function(e){return this.rivets=t.factory(e)}):this.rivets=t.factory(sightglass)}.call(this),define("mcore/route",["mcore/util"],function(t){"use strict";var e,i,n;return n=function(t,e,i,n){var r;return null==e&&(e=[]),null==i&&(i=!1),null==n&&(n=!1),t instanceof RegExp?t:(r=function(t,i,n,r,o,s){return e.push({name:r,optional:!!s}),i=i||"",""+(s&&""||i)+"(?:"+(s&&i||"")+(n||"")+(o||n&&"([^/.]+?)"||"([^/]+?)")+")"+(s||"")},t=t.concat(n&&""||"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,r).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",i&&""||"i"))},i=function(e){var i,n,r,o,s;return e=String(e),i="",r=[],-1!==e.indexOf("?")?i=e.split("?").pop():-1!==e.indexOf("&")&&(i=e),""===i?{}:(n=i.split("&"),o={},s=[],n.forEach(function(e){var i,n;-1!==e.indexOf("=")&&(e=e.split("="),2===e.length&&(i=e[0].trim(),n=e[1],n=t.isNumber(n)?Number(n):decodeURIComponent(n),o[i]=n))}),o)},e=function(t,i,n){
this.hashchange=null!=t?t:e.changeByLocationHash,this.sensitive=null!=i?i:!1,this.strict=null!=n?n:!1,this.rule=[]},e.prototype.run=function(){this.hashchange(function(t){return function(e){t.match(e)}}(this))},e.prototype.add=function(t,e){var i,r;return i=[],r=n(t,i,this.sensitive,this.strict),this.rule.push({path:t,reg:r,keys:i,fn:e}),this},e.prototype.match=function(e){var n,r,o,s,a;return a=String(e),r=a,n="",o=a.indexOf("?"),-1===o&&(o=a.indexOf("&")),s=!1,-1!==o&&(n=a.substring(o),a=a.substring(0,o)),t.each(this.rule,function(e){var o,l,u,c,h,p,f,d,_,m;if(s)return!1;if(d=e.reg.exec(a),null!==d){for(s=!0,l=i(n),u={},o=[],h=p=1,_=d.length;_>=1?_>p:p>_;h=_>=1?++p:--p)f=e.keys[h-1],m=d[h],t.isNumber(m)?m=Number(m):m&&(m=decodeURIComponent(m)),f&&f.name&&(u[f.name]=m),o.push(m||null);c={url:r,path:a,args:n,rule:e.path,context:l,keys:e.keys,data:u},e.fn.apply(c,o)}}),this},e.changeByLocationHash=function(t){var e;return e=function(){return t(window.location.hash.substring(1))},window.addEventListener?window.addEventListener("hashchange",e,!1):window.attachEvent("onhashchange",e),e()},e.changeByHistory=function(t){var i;return window.history||e.changeByLocationHash(t),i=function(){return t(window.location.hash.substring(1))},window.onpopstate=function(t){return i()},i()},{pathToRegexp:n,pathToObject:i,Route:e}}),function(){var t=[].slice;define("mcore/template",["jquery","rivets","mcore/util","stapes"],function(e,i,n,r){"use strict";var o;return i.adapters[":"]={observe:function(t,e,i){t.on("change:"+e,i)},unobserve:function(t,e,i){t.off("change:"+e,i)},get:function(t,e){return t.get(e)},set:function(t,e,i){t.set(e,i)}},i.configure({rootInterface:".",handler:function(t,e,i){var n;return n=this.call(i.view.models.self,t,e),!1===n?e.stopPropagation&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1):void 0}}),i.formatters.nl2br=function(t){return t?String(t).trim().replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2"):""},i.formatters.link=function(t,e){return t?String(t)+String(e):""},i.formatters.and=function(t,e){return t?e:t},i.formatters.or=function(t,e){return t?t:e},i.formatters.slice=function(t,e,i){return!1===Array.isArray(t)?[]:t.slice(e,i)},i.formatters.substr=function(t,e,i){return t?String(t).substring(e,i):""},i.formatters.len=function(t){return Array.isArray(t)?t.length:t?String(t).length:0},i.formatters.eq=function(t,e){return t===e},i.formatters["<"]=function(t,e){return Number(t)<Number(e)},i.formatters["<="]=function(t,e){return Number(t)<=Number(e)},i.formatters["=="]=function(t,e){return Number(t)===Number(e)},i.formatters[">="]=function(t,e){return Number(t)>=Number(e)},i.formatters[">"]=function(t,e){return Number(t)>Number(e)},i.formatters["+"]=function(t,e){return Number(t)+Number(e)},i.formatters["-"]=function(t,e){return Number(t)-Number(e)},i.formatters["*"]=function(t,e){return Number(t)*Number(e)},i.formatters["/"]=function(t,e){return Number(t)/Number(e)},i.formatters.isArray=function(t){return Array.isArray(t)},i.formatters.eachObject=function(t){var e,i,r,o;if(!1===n.isObject(t))return[];e=[],r=[];for(i in t)o=t[i],r.push(e.push({key:i,value:o}));return r},i.formatters.toFixed=function(t,e){return null==e&&(e=1),!1===n.isNumber(t)?0:Number(t).toFixed(e)},i.formatters["in"]=function(){var e,i;return e=1<=arguments.length?t.call(arguments,0):[],e.length<2?!1:(i=e[0],e.splice(0,1),n.isNumber(i)&&(i=Number(i)),-1!==e.indexOf(i))},o=function(t,e){this.view=t,this.data=null!=e?e:{},this.rv=!1},o.prototype.init=function(){var t,n,r,s;return t=this.data,r=Object.keys(t),n=e.Deferred(),0===r.length?(s=i.bind(this.view.$el,{self:this.view}),this.rv=s,n.resolve(s)):o.loadPromise(t).done(function(t){return function(e){r.forEach(function(i){var n;return n=e[i],null!=n?t.view.set(i,n):void 0}),s=i.bind(t.view.$el,{self:t.view}),t.rv=s,n.resolve(s)}}(this)).fail(function(){return n.reject("template render error")}),n.promise()},o.prototype.set=function(t,e){return e.then(function(e){return function(i){return e.view.set(t,i)}}(this))},o.prototype.update=function(t){var i,n;return null==t&&(t={}),i=e.Deferred(),!1===this.rv?i.reject("Template no init"):(n=Object.keys(t),o.loadPromise(t).done(function(t){return function(e){n.forEach(function(i){var n;return n=e[i],null!=n?t.view.set(i,n):void 0}),i.resolve(e)}}(this)).fail(function(){return i.reject("template update error")})),i.promise()},o.prototype.destroy=function(){return this.rv?this.rv.unbind():void 0},o.loadPromise=function(i){var n,r,o;return n=e.Deferred(),r=Object.keys(i),0===r.length?n.resolve({}):(o=[],r.forEach(function(t){return function(t){return o.push(i[t])}}(this)),e.when.apply(null,o).done(function(){var e,i;return e=1<=arguments.length?t.call(arguments,0):[],i={},e.forEach(function(t){return function(t,e){var n;return n=r[e],n?(Array.isArray(t)&&3===t.length&&t[2].promise&&(t=t[0]),i[n]=t):void 0}}(this)),n.resolve(i)}).fail(function(t){return console.log(t),n.reject(t)})),n.promise()},o.loadTpl=function(t){var i,n;return i=e.Deferred(),n=String(t).split("/"),2===n.length?requirejs(["tpl/"+n[0]],function(t){var e;return e=t[n[1]],e?i.resolve(e):i.reject("url data map error")}):i.reject("uri error: "+t),i.promise()},o.renderString=function(t,e,i){var n,r,s;return null==e&&(e={}),s=Object.keys(e),s.length>0&&!i.tpl&&s.forEach(function(t){return function(t){return i.set(t,{})}}(this)),i.tpl?i.tpl.update(e).then(function(){return i.emit("tplUpdate")}):(n=i.$el.parent(),r=n.length>0,r&&i.$el.detach(),i.$el.append(t),i.tpl=new o(i,e),i.tpl.init().then(function(){return r&&i.$el.appendTo(n),i.emit("render"),i.tpl}))},o.render=function(t,e,i){return null==e&&(e={}),o.loadTpl(t).then(function(t){return o.renderString(t,e,i)})},o.formatters=function(t,e){return i.formatters[t]=e},o.Attr=r.subclass({constructor:function(t,i,n){return this.name=t,this.rv=i,this.el=n,this.$el=e(this.el),this.init(this.el),this.watch()},sync:function(t){return this.rv.observer.setValue(t)},init:function(t){},update:function(t,e){},destroy:function(t){},watch:function(){}}),o.regAttr=function(t,e){var n;return n=null,i.binders[t]={bind:function(i){return n=new e(t,this,i)},unbind:function(t){return n.destroy(t)},routine:function(t,e){return n.update(e,t)}}},o.regTag=function(t,e){return null==e&&(e={}),i.components[t]={"static":e["static"]||[],attributes:e.attr||[],template:e.template||function(){return""},initialize:e.init||function(){}}},o})}.call(this),function(){define("mcore/ui",["jquery","mcore/template","stapes"],function(t,e,i){"use strict";return i.subclass({constructor:function(e,i){return this.options=null!=i?i:{},this.$el=t("<div/>"),this.$parent=e,this.on("render",function(t){return function(){return t.$el.appendTo(t.$parent)}}(this)),this.init(),this.watch()},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},render:function(t,i){return null==i&&(i={}),e.render(t,i,this)},renderString:function(t,i){return null==i&&(i={}),e.renderString(t,i,this)},init:function(){},watch:function(){}})})}.call(this),function(){define("mcore/view",["jquery","mcore/template","stapes","mcore/util"],function(t,e,i,n){"use strict";var r,o,s,a;return o=t(window),r=t("body"),a=/MicroMessenger/i.test(window.navigator.userAgent),s=/iphone|ipad/gi.test(window.navigator.appVersion),i.subclass({constructor:function(t,e){return this.$el=t,this.app=e,this.$win=o,this.$body=r,this.util=n,this._cacheMap={},this.isWeixinBrowser=a,this.isIOS=s,this.tpl=!1,this.beforeInit(),this.init(),this.watch()},clone:function(t){return n.clone(t)},setTitle:function(e){var i;return this.title=e,document.title!==this.title?(document.title=this.title,this.isWeixinBrowser&&this.isIOS?(i=t('<iframe src="/favicon.ico"></iframe>'),i.one("load",function(){return setTimeout(function(){return i.remove()},0)}).appendTo(this.$body)):void 0):void 0},render:function(t,i){return null==i&&(i={}),e.render(t,i,this)},renderString:function(t,i){return null==i&&(i={}),e.renderString(t,i,this)},when:function(){return t.when.apply(this,arguments)},destroy:function(){return this.tpl&&this.tpl.destroy(),this.$el.remove()},memoryCache:function(t){var e,i;return i=n.promiseCacheMemoryproxy,e={has:function(e){return n.promiseCache(t,e,{proxy:i})},remove:function(){return i.remove(t)}}},localCache:function(t){var e,i;return i=n.promiseCacheLocalProxy,e={has:function(e,r){return null==r&&(r=1/0),n.promiseCache(t,e,{proxy:i,time:r})},remove:function(){return i.remove(t)}}},sessionCach:function(t){var e,i;return i=this.promiseCacheSessionProxy(),e={has:function(e){return n.promiseCache(t,e,{proxy:i})},remove:function(){return i.remove(t)}}},promiseCacheSessionProxy:function(){var t;return t={set:function(t){return function(e,i){return t._cacheMap[e]=i}}(this),get:function(t){return function(e){return t._cacheMap[e]||null}}(this)}},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},beforeInit:function(){},init:function(){},run:function(){},afterRun:function(){},watch:function(){}})})}.call(this),function(){define("mcore/util",function(){"use strict";var t,e,i,n,r;return r={},e=/^-{0,1}\d*\.{0,1}\d+$/,t="__cache_",i=window.localStorage,n={},r.isNumber=function(t){return e.test(t)},r.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},r.clone=function(t){return JSON.parse(JSON.stringify(t))},r.cache={set:function(e,n,r){var o;return null==r&&(r=1/0),r!==1/0&&(r=(new Date).getTime()+parseInt(r)),o={time:r,value:n},i.setItem(t+e,JSON.stringify(o))},get:function(e,n){var o,s;return null==n&&(n=null),(s=i.getItem(t+e))?(s=JSON.parse(s),o=(new Date).getTime(),o<=s.time?s.value:(r.cache.remove(e),n)):n},remove:function(e){return i.removeItem(t+e)}},r.promiseCache=function(t,e,i){var n,o;return n=i.proxy.get(t),n?(o=$.Deferred(),o.resolve(r.clone(n)),o.promise()):e().then(function(e){return i.proxy.set(t,r.clone(e),i.time)})},r.promiseCacheLocalProxy={set:r.cache.set,get:r.cache.get,remove:r.cache.remove},r.promiseCacheMemoryproxy={set:function(t,e){return n[t]=e},get:function(t){return n[t]||null},remove:function(t){return delete n[t]}},r.each=function(t,e){var i,n,r;if(null==e&&(e=function(){}),!1!==Array.isArray(t))for(i in t)if(r=t[i],n=e(r,i),!1===n)break},r})}.call(this),function(){define("mcore/app",["jquery","stapes","mcore/route"],function(t,e,i){"use strict";return e.subclass({constructor:function(e,n){this.$el=e,null==n&&(n={}),this.options=t.extend({viewClass:"mcore-app-view",routeChange:i.Route.changeByLocationHash},n),this.router=new i.Route(this.options.routeChange),this.curView=null,this.onLoadViw=!1},route:function(t,e){var i;return i=this,this.router.add(t,function(){return i.runView(e,this,arguments)}),this},runView:function(e,i,n){if(!this.onLoadViw){if(this.curView){if(this.curView.name===e)return this.curView.instantiate.route=i,this.curView.instantiate.context=i.context,this.curView.instantiate.run.apply(this.curView.instantiate,n),void this.emit("runView",this.curView);this.emit("destroyView",this.curView),this.curView.instantiate.destroy(),this.curView=null}return this.onLoadViw=!0,requirejs([e],function(r){return function(o){var s;return s=t("<div class='"+r.options.viewClass+"' />"),r.curView={name:e,instantiate:new o(s,r)},r.curView.instantiate.route=i,r.curView.instantiate.context=i.context,r.curView.instantiate.run.apply(r.curView.instantiate,n),r.curView.instantiate.$el.appendTo(r.$el),r.emit("runView",r.curView),r.curView.instantiate.afterRun(),r.onLoadViw=!1}}(this))}},run:function(){return this.router.run()}})})}.call(this),function(){define("mcore",["mcore/util","mcore/template","mcore/view","mcore/route","mcore/ui","mcore/app"],function(t,e,i,n,r,o){"use strict";var s;return s={util:t,Template:e,View:i,Route:n,Ui:r,App:o}})}.call(this),define("formSerializer",["jquery"],function(t){"use strict";var e=function(t){function e(e,n){function r(t,e,i){return t[e]=i,t}function o(t,e){for(var n,o=t.match(i.key);void 0!==(n=o.pop());)if(i.push.test(n)){var a=s(t.replace(/\[\]$/,""));e=r([],a,e)}else i.fixed.test(n)?e=r([],n,e):i.named.test(n)&&(e=r({},n,e));return e}function s(t){return void 0===f[t]&&(f[t]=0),f[t]++}function a(e){switch(t('[name="'+e.name+'"]',n).attr("type")){case"checkbox":return"on"===e.value?!0:e.value;default:return e.value}}function l(t){if(!i.validate.test(t.name))return this;var n=o(t.name,a(t));return p=e.extend(!0,p,n),this}function u(t){if(!e.isArray(t))throw new Error("formSerializer.addPairs expects an Array");for(var i=0,n=t.length;n>i;i++)this.addPair(t[i]);return this}function c(){return p}function h(){return JSON.stringify(c())}var p={},f={};this.addPair=l,this.addPairs=u,this.serialize=c,this.serializeJSON=h}var i={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,fixed:/^\d+$/,named:/^[a-z0-9_]+$/i};return e.patterns=i,e.serializeObject=function(){return new e(t,this).addPairs(this.serializeArray()).serialize()},e.serializeJSON=function(){return new e(t,this).addPairs(this.serializeArray()).serializeJSON()},"undefined"!=typeof t.fn&&(t.fn.serializeObject=e.serializeObject,t.fn.serializeJSON=e.serializeJSON),e}(t);return e}),define("scroller",function(){"use strict";!function(t){var e=Date.now||function(){return+new Date},i=60,n=1e3,r={},o=1;t.core?core.effect||(core.effect={}):t.core={effect:{}},core.effect.Animate={requestAnimationFrame:function(){var e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame,i=!!e;if(e&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(e.toString())&&(i=!1),i)return function(t,i){e(t,i)};var n=60,r={},o=0,s=1,a=null,l=+new Date;return function(t,e){var i=s++;return r[i]=t,o++,null===a&&(a=setInterval(function(){var t=+new Date,e=r;r={},o=0;for(var i in e)e.hasOwnProperty(i)&&(e[i](t),l=t);t-l>2500&&(clearInterval(a),a=null)},1e3/n)),i}}(),stop:function(t){var e=null!=r[t];return e&&(r[t]=null),e},isRunning:function(t){return null!=r[t]},start:function(t,s,a,l,u,c){var h=e(),p=h,f=0,d=0,_=o++;if(c||(c=document.body),_%20===0){var m={};for(var v in r)m[v]=!0;r=m}var g=function(o){var m=o!==!0,v=e();if(!r[_]||s&&!s(_))return r[_]=null,void(a&&a(i-d/((v-h)/n),_,!1));if(m)for(var b=Math.round((v-p)/(n/i))-1,y=0;y<Math.min(b,4);y++)g(!0),d++;l&&(f=(v-h)/l,f>1&&(f=1));var w=u?u(f):f;t(w,v,m)!==!1&&1!==f||!m?m&&(p=v,core.effect.Animate.requestAnimationFrame(g,c)):(r[_]=null,a&&a(i-d/((v-h)/n),_,1===f||null==l))};return r[_]=!0,core.effect.Animate.requestAnimationFrame(g,c),_}}}(window);var t;return function(){var e=function(){};t=function(t,i){this.__callback=t,this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:e,penetrationDeceleration:.03,penetrationAcceleration:.08};for(var n in i)this.options[n]=i[n]};var i=function(t){return Math.pow(t-1,3)+1},n=function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},r={__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(t,e,i,n){var r=this;t===+t&&(r.__clientWidth=t),e===+e&&(r.__clientHeight=e),i===+i&&(r.__contentWidth=i),n===+n&&(r.__contentHeight=n),r.__computeScrollMax(),r.scrollTo(r.__scrollLeft,r.__scrollTop,!0)},setPosition:function(t,e){var i=this;i.__clientLeft=t||0,i.__clientTop=e||0},setSnapSize:function(t,e){var i=this;i.__snapWidth=t,i.__snapHeight=e},activatePullToRefresh:function(t,e,i,n){var r=this;r.__refreshHeight=t,r.__refreshActivate=e,r.__refreshDeactivate=i,r.__refreshStart=n},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var t=this;t.__refreshActive=!1,t.__refreshDeactivate&&t.__refreshDeactivate(),t.scrollTo(t.__scrollLeft,t.__scrollTop,!0)},getValues:function(){var t=this;return{left:t.__scrollLeft,top:t.__scrollTop,zoom:t.__zoomLevel}},getScrollMax:function(){var t=this;return{left:t.__maxScrollLeft,top:t.__maxScrollTop}},zoomTo:function(t,e,i,n,r){var o=this;if(!o.options.zooming)throw new Error("Zooming is not enabled!");r&&(o.__zoomComplete=r),o.__isDecelerating&&(core.effect.Animate.stop(o.__isDecelerating),o.__isDecelerating=!1);var s=o.__zoomLevel;null==i&&(i=o.__clientWidth/2),null==n&&(n=o.__clientHeight/2),t=Math.max(Math.min(t,o.options.maxZoom),o.options.minZoom),o.__computeScrollMax(t);var a=(i+o.__scrollLeft)*t/s-i,l=(n+o.__scrollTop)*t/s-n;a>o.__maxScrollLeft?a=o.__maxScrollLeft:0>a&&(a=0),l>o.__maxScrollTop?l=o.__maxScrollTop:0>l&&(l=0),o.__publish(a,l,t,e)},zoomBy:function(t,e,i,n,r){var o=this;o.zoomTo(o.__zoomLevel*t,e,i,n,r)},scrollTo:function(t,e,i,n){var r=this;if(r.__isDecelerating&&(core.effect.Animate.stop(r.__isDecelerating),r.__isDecelerating=!1),null!=n&&n!==r.__zoomLevel){if(!r.options.zooming)throw new Error("Zooming is not enabled!");t*=n,e*=n,r.__computeScrollMax(n)}else n=r.__zoomLevel;r.options.scrollingX?r.options.paging?t=Math.round(t/r.__clientWidth)*r.__clientWidth:r.options.snapping&&(t=Math.round(t/r.__snapWidth)*r.__snapWidth):t=r.__scrollLeft,r.options.scrollingY?r.options.paging?e=Math.round(e/r.__clientHeight)*r.__clientHeight:r.options.snapping&&(e=Math.round(e/r.__snapHeight)*r.__snapHeight):e=r.__scrollTop,t=Math.max(Math.min(r.__maxScrollLeft,t),0),e=Math.max(Math.min(r.__maxScrollTop,e),0),t===r.__scrollLeft&&e===r.__scrollTop&&(i=!1),r.__publish(t,e,n,i)},scrollBy:function(t,e,i){var n=this,r=n.__isAnimating?n.__scheduledLeft:n.__scrollLeft,o=n.__isAnimating?n.__scheduledTop:n.__scrollTop;n.scrollTo(r+(t||0),o+(e||0),i)},doMouseZoom:function(t,e,i,n){var r=this,o=t>0?.97:1.03;return r.zoomTo(r.__zoomLevel*o,!1,i-r.__clientLeft,n-r.__clientTop)},doTouchStart:function(t,e){if(null==t.length)throw new Error("Invalid touch list: "+t);if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var i=this;i.__interruptedAnimation=!0,i.__isDecelerating&&(core.effect.Animate.stop(i.__isDecelerating),i.__isDecelerating=!1,i.__interruptedAnimation=!0),i.__isAnimating&&(core.effect.Animate.stop(i.__isAnimating),i.__isAnimating=!1,i.__interruptedAnimation=!0);var n,r,o=1===t.length;o?(n=t[0].pageX,r=t[0].pageY):(n=Math.abs(t[0].pageX+t[1].pageX)/2,r=Math.abs(t[0].pageY+t[1].pageY)/2),i.__initialTouchLeft=n,i.__initialTouchTop=r,i.__zoomLevelStart=i.__zoomLevel,i.__lastTouchLeft=n,i.__lastTouchTop=r,i.__lastTouchMove=e,i.__lastScale=1,i.__enableScrollX=!o&&i.options.scrollingX,i.__enableScrollY=!o&&i.options.scrollingY,i.__isTracking=!0,i.__didDecelerationComplete=!1,i.__isDragging=!o,i.__isSingleTouch=o,i.__positions=[]},doTouchMove:function(t,e,i){if(null==t.length)throw new Error("Invalid touch list: "+t);if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e);var n=this;if(n.__isTracking){var r,o;2===t.length?(r=Math.abs(t[0].pageX+t[1].pageX)/2,o=Math.abs(t[0].pageY+t[1].pageY)/2):(r=t[0].pageX,o=t[0].pageY);var s=n.__positions;if(n.__isDragging){var a=r-n.__lastTouchLeft,l=o-n.__lastTouchTop,u=n.__scrollLeft,c=n.__scrollTop,h=n.__zoomLevel;if(null!=i&&n.options.zooming){var p=h;if(h=h/n.__lastScale*i,h=Math.max(Math.min(h,n.options.maxZoom),n.options.minZoom),p!==h){var f=r-n.__clientLeft,d=o-n.__clientTop;u=(f+u)*h/p-f,c=(d+c)*h/p-d,n.__computeScrollMax(h)}}if(n.__enableScrollX){u-=a*this.options.speedMultiplier;var _=n.__maxScrollLeft;(u>_||0>u)&&(n.options.bouncing?u+=a/2*this.options.speedMultiplier:u=u>_?_:0)}if(n.__enableScrollY){c-=l*this.options.speedMultiplier;var m=n.__maxScrollTop;(c>m||0>c)&&(n.options.bouncing?(c+=l/2*this.options.speedMultiplier,n.__enableScrollX||null==n.__refreshHeight||(!n.__refreshActive&&c<=-n.__refreshHeight?(n.__refreshActive=!0,n.__refreshActivate&&n.__refreshActivate()):n.__refreshActive&&c>-n.__refreshHeight&&(n.__refreshActive=!1,n.__refreshDeactivate&&n.__refreshDeactivate()))):c=c>m?m:0)}s.length>60&&s.splice(0,30),s.push(u,c,e),n.__publish(u,c,h)}else{var v=n.options.locking?3:0,g=5,b=Math.abs(r-n.__initialTouchLeft),y=Math.abs(o-n.__initialTouchTop);n.__enableScrollX=n.options.scrollingX&&b>=v,n.__enableScrollY=n.options.scrollingY&&y>=v,s.push(n.__scrollLeft,n.__scrollTop,e),n.__isDragging=(n.__enableScrollX||n.__enableScrollY)&&(b>=g||y>=g),n.__isDragging&&(n.__interruptedAnimation=!1)}n.__lastTouchLeft=r,n.__lastTouchTop=o,n.__lastTouchMove=e,n.__lastScale=i}},doTouchEnd:function(t){if(t instanceof Date&&(t=t.valueOf()),"number"!=typeof t)throw new Error("Invalid timestamp value: "+t);var e=this;if(e.__isTracking){if(e.__isTracking=!1,e.__isDragging)if(e.__isDragging=!1,e.__isSingleTouch&&e.options.animating&&t-e.__lastTouchMove<=100){for(var i=e.__positions,n=i.length-1,r=n,o=n;o>0&&i[o]>e.__lastTouchMove-100;o-=3)r=o;if(r!==n){var s=i[n]-i[r],a=e.__scrollLeft-i[r-2],l=e.__scrollTop-i[r-1];e.__decelerationVelocityX=a/s*(1e3/60),e.__decelerationVelocityY=l/s*(1e3/60);var u=e.options.paging||e.options.snapping?4:1;(Math.abs(e.__decelerationVelocityX)>u||Math.abs(e.__decelerationVelocityY)>u)&&(e.__refreshActive||e.__startDeceleration(t))}else e.options.scrollingComplete()}else t-e.__lastTouchMove>100&&e.options.scrollingComplete();e.__isDecelerating||(e.__refreshActive&&e.__refreshStart?(e.__publish(e.__scrollLeft,-e.__refreshHeight,e.__zoomLevel,!0),e.__refreshStart&&e.__refreshStart()):((e.__interruptedAnimation||e.__isDragging)&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0,e.__zoomLevel),e.__refreshActive&&(e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate()))),e.__positions.length=0}},__publish:function(t,e,r,o){var s=this,a=s.__isAnimating;if(a&&(core.effect.Animate.stop(a),s.__isAnimating=!1),o&&s.options.animating){s.__scheduledLeft=t,s.__scheduledTop=e,s.__scheduledZoom=r;var l=s.__scrollLeft,u=s.__scrollTop,c=s.__zoomLevel,h=t-l,p=e-u,f=r-c,d=function(t,e,i){i&&(s.__scrollLeft=l+h*t,s.__scrollTop=u+p*t,s.__zoomLevel=c+f*t,s.__callback&&s.__callback(s.__scrollLeft,s.__scrollTop,s.__zoomLevel))},_=function(t){return s.__isAnimating===t},m=function(t,e,i){e===s.__isAnimating&&(s.__isAnimating=!1),(s.__didDecelerationComplete||i)&&s.options.scrollingComplete(),s.options.zooming&&(s.__computeScrollMax(),s.__zoomComplete&&(s.__zoomComplete(),s.__zoomComplete=null))};s.__isAnimating=core.effect.Animate.start(d,_,m,s.options.animationDuration,a?i:n)}else s.__scheduledLeft=s.__scrollLeft=t,s.__scheduledTop=s.__scrollTop=e,s.__scheduledZoom=s.__zoomLevel=r,s.__callback&&s.__callback(t,e,r),s.options.zooming&&(s.__computeScrollMax(),s.__zoomComplete&&(s.__zoomComplete(),s.__zoomComplete=null))},__computeScrollMax:function(t){var e=this;null==t&&(t=e.__zoomLevel),e.__maxScrollLeft=Math.max(e.__contentWidth*t-e.__clientWidth,0),e.__maxScrollTop=Math.max(e.__contentHeight*t-e.__clientHeight,0)},__startDeceleration:function(t){var e=this;if(e.options.paging){var i=Math.max(Math.min(e.__scrollLeft,e.__maxScrollLeft),0),n=Math.max(Math.min(e.__scrollTop,e.__maxScrollTop),0),r=e.__clientWidth,o=e.__clientHeight;e.__minDecelerationScrollLeft=Math.floor(i/r)*r,e.__minDecelerationScrollTop=Math.floor(n/o)*o,e.__maxDecelerationScrollLeft=Math.ceil(i/r)*r,e.__maxDecelerationScrollTop=Math.ceil(n/o)*o}else e.__minDecelerationScrollLeft=0,e.__minDecelerationScrollTop=0,e.__maxDecelerationScrollLeft=e.__maxScrollLeft,e.__maxDecelerationScrollTop=e.__maxScrollTop;var s=function(t,i,n){e.__stepThroughDeceleration(n)},a=e.options.snapping?4:.1,l=function(){var t=Math.abs(e.__decelerationVelocityX)>=a||Math.abs(e.__decelerationVelocityY)>=a;return t||(e.__didDecelerationComplete=!0),t},u=function(t,i,n){e.__isDecelerating=!1,e.__didDecelerationComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping)};e.__isDecelerating=core.effect.Animate.start(s,l,u)},__stepThroughDeceleration:function(t){var e=this,i=e.__scrollLeft+e.__decelerationVelocityX,n=e.__scrollTop+e.__decelerationVelocityY;if(!e.options.bouncing){var r=Math.max(Math.min(e.__maxDecelerationScrollLeft,i),e.__minDecelerationScrollLeft);r!==i&&(i=r,e.__decelerationVelocityX=0);var o=Math.max(Math.min(e.__maxDecelerationScrollTop,n),e.__minDecelerationScrollTop);o!==n&&(n=o,e.__decelerationVelocityY=0)}if(t?e.__publish(i,n,e.__zoomLevel):(e.__scrollLeft=i,e.__scrollTop=n),!e.options.paging){var s=.95;e.__decelerationVelocityX*=s,e.__decelerationVelocityY*=s}if(e.options.bouncing){var a=0,l=0,u=e.options.penetrationDeceleration,c=e.options.penetrationAcceleration;i<e.__minDecelerationScrollLeft?a=e.__minDecelerationScrollLeft-i:i>e.__maxDecelerationScrollLeft&&(a=e.__maxDecelerationScrollLeft-i),n<e.__minDecelerationScrollTop?l=e.__minDecelerationScrollTop-n:n>e.__maxDecelerationScrollTop&&(l=e.__maxDecelerationScrollTop-n),0!==a&&(a*e.__decelerationVelocityX<=0?e.__decelerationVelocityX+=a*u:e.__decelerationVelocityX=a*c),0!==l&&(l*e.__decelerationVelocityY<=0?e.__decelerationVelocityY+=l*u:e.__decelerationVelocityY=l*c)}}};for(var o in r)t.prototype[o]=r[o]}(),{Scroller:t}}),function(){var t=[].slice;define("mcore-attr/validator",["jquery","mcore/template","formSerializer"],function(e,i){"use strict";var n,r,o,s,a,l,u,c,h,p,f;return r=/^[A-Za-z]+$/,s=/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,o=/^([1-2]\d{3})([-\/.])?(1[0-2]|0?[1-9])([-\/.])?([1-2]\d|3[01]|0?[1-9])$/,l=/^1[3-9]\d{9}$/,u=/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,a=/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i,f=function(){var t,e,i,n,r,o,s,a,l,u;return s="((https?|s?ftp|irc[6s]?|git|afp|telnet|smb):\\/\\/)?",u="([a-z0-9]\\w*(\\:[\\S]+)?\\@)?",e="(?:localhost|(?:[a-z0-9]+(?:[-\\w]*[a-z0-9])?(?:\\.[a-z0-9][-\\w]*[a-z0-9])*)*\\.[a-z]{2,})",o="(:\\d{1,5})?",n="\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",t="(\\/\\S*)?",i=[s,u,e,o,t],r=[s,u,n,o,t],a=new RegExp("^"+i.join("")+"$","i"),l=new RegExp("^"+r.join("")+"$","i"),function(t){return a.test(t||l.test(t))}}(),c={required:"",isNumber:"",isAlphabet:"",minlength:function(t){return" "+t+" "},maxlength:function(t){return" "+t+" "},min:function(t){return" "+t},max:function(t){return" "+t},equals:"",isEmail:"",isInteger:"",isDate:"",isMobile:"",isTel:"",isIdentityCode:""},p={required:function(t){return null==t&&(t=""),String(t).trim().length>0},isAlphabet:function(t){return r.test(t)},minlength:function(t,e){return e=Number(e),t=String(t).trim(),t.length>=e},maxlength:function(t,e){return e=Number(e),t=String(t).trim(),t.length<e},isNumber:function(t){return e.isNumeric(t)},isInteger:function(t){return Number(t)%1===0},min:function(t,e){return Number(t)>=Number(e)},max:function(t,e){return Number(t)<=Number(e)},equals:function(t,e){return String(t)===String(e)},isEmail:function(t){return s.test(t)},isDate:function(t){var e,i,n,r,s;return o.test(t)?!1:(r=o.exec(t),s=Number(r[1]),n=Number(r[3]-1),i=Number(r[5]),e=new Date(s,n,i),s===e.getFullYear()&&n===e.getMonth()&&i===e.getDate())},isMobile:function(t){return l.test(t)},isTel:function(t){return u.test(t)},isIdentityCode:function(t){var e,i,n,r,o,s,l,u,c,h;if(i={11:"",12:"",13:"",14:"",15:"",21:"",22:"",23:"",31:"",32:"",33:"",34:"",35:"",36:"",37:"",41:"",42:"",43:"",44:"",45:"",46:"",50:"",51:"",52:"",53:"",54:"",61:"",62:"",63:"",64:"",65:"",71:"",81:"",82:"",91:""},a.test(t))return!1;if(!i[t.substr(0,2)])return!1;if(18===t.length){for(n=t.split(""),r=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],u=[1,0,"X",9,8,7,6,5,4,3,2],c=0,e=0,h=0,o=s=0;17>s;o=++s)e=n[o],h=r[o],c+=e*h;if(l=u[c%11],l!==n[17])return!1}return!0},isUrl:function(t){return f(t)}},n=i.Attr.subclass({constructor:i.Attr.prototype.constructor,init:function(){return this.$el.is("form")===!1?!1:this.$el.data("check",function(t){return function(){return t.initRules(),t.check()}}(this))},update:function(t){return this.$el.is("form")?void 0:t?this.$el.attr("validator",t):this.$el.removeAttr("validator")},check:function(){var t,i,n,r;return r=!0,i=this.$el.serializeObject(),n=null,t=this.$el,e.each(this.rules,function(e,o){var s;if("required"===o.type||""!==i[o.name]&&void 0!==i[o.name])return s=o.args[0],o.args[0]=i[o.name],!1===o.rule.apply(null,o.args)?(n=function(){return{$el:s,err:o.err,$form:t}},r=!1,!1):void 0}),r&&i||n},initRules:function(){var t;return t=this,this.rules=[],this.$validators=this.$el.find("[validator]"),this.$validators.each(function(){return t.parseValidator(e(this))})},parseValidator:function(t){var i;return(i=t.attr("name"))?t.attr("validator").split("|").forEach(function(n){return function(r){var o,s,a,l,u,h;return o=r.split(" ").filter(function(t){return e.trim(t).length>0}),h=o[0],(s=p[h])?(u=String(o[o.length-1]).trim(),a=c[h]||"",l=u.indexOf("err:"),0===l&&(a=u.substring(4)),e.isFunction(a)&&(a=a.apply(null,o.slice(1))),o[0]=t,"equals"===h&&(o[1]=n.$el.find(o[1]).eq(0)),n.rules.push({name:i,type:h,rule:s,args:o,err:a})):void console.log("validator rule: "+h+" undefined")}}(this)):void 0}}),i.regAttr("validator",n),h={add:function(t,e){return p[t]=e},check:function(){var e,i;return e=1<=arguments.length?t.call(arguments,0):[],e.length<2?!1:(i=e[0],e.splice(0,1),p[i]?p[i].apply(null,e):!1)},addErrMsg:function(t,e){return c[t]=e},ValidatorAttr:n}})}.call(this),function(){define("mcore-attr/scroller",["jquery","mcore/template","scroller"],function(t,e,i){"use strict";var n,r,o,s,a,l,u,c,h,p,f;r=t(window),n=t(document),s=document.documentElement.style,s.hasOwnProperty("WebkitAppearance")?a="webkit":s.hasOwnProperty("MozAppearance")?a="gecko":"string"==typeof navigator.cpuClass?a="trident":window.opera&&"[object Opera]"===Object.prototype.toString.call(opera)&&(a="presto"),f={webkit:"Webkit",trident:"ms",gecko:"Moz",presto:"O"}[a],l=document.createElement("div"),c=f+"Perspective",p=f+"Transform",h=function(t){return l.style.hasOwnProperty(c)?function(e,i,n){t.style[p]="translate3d("+-e+"px, "+-i+"px,0) scale("+n+")"}:l.style.hasOwnProperty(p)?function(e,i,n){t.style[p]="translate("+-e+"px, "+-i+"px,0) scale("+n+")"}:function(e,i,n){t.style.marginLeft=e&&-e/n+"px"||"",t.style.marginTop=i&&-i/n+"px"||"",t.style.zoom=n||""}},o=0,u=function(t,e){var i;return null==e&&(e=function(){}),t?(i=new Image,i.onload=e,i.onerror=e,i.src=t):e()},e.regAttr("scroller",e.Attr.subclass({constructor:e.Attr.prototype.constructor,init:function(){return o++,this.id=o,this.scrollingY="yes"===this.$el.attr("data-scrolling-y"),this.scrollingX="yes"===this.$el.attr("data-scrolling-x"),this.scrollingX===this.scrollingY&&this.scrollingX===!1&&(this.scrollingY=!0),this.height=Number(this.$el.attr("data-scrolling-height")||0),this.width=Number(this.$el.attr("data-scrolling-width")||0),this.loadImgTime=!1,this.$el.wrap('<div class="scroller-wrap"></div>'),this.$container=this.$el.parent().css({overflow:"hidden",position:"relative"}),this.$el.css({position:"absolute"}),this.scrollingX===!1&&this.$el.css({width:"100%"}),this.scroller=new i.Scroller(h(this.$el[0]),{scrollingX:this.scrollingX,scrollingY:this.scrollingY,
zooming:!1,locking:!1}),this.$el.data("scroller",this.scroller),this.soureSize={width:0,height:0},this.size={width:0,height:0},this.resize()},update:function(e,i){var n,r,o;return this.$el=t(i),this.resize(),n=this.$el.find("img"),r=n.length,r>0?(this.loadImgTime&&clearTimeout(this.loadImgTime),o=0,this.loadImgTime=setTimeout(function(t){return function(){var e;return e=t,n.each(function(){return u(this.src,function(){return o++,o===r?e.resize():void 0})})}}(this),300)):void 0},destroy:function(){return this.$el.remove(),r.off("touchmove.scroller"+this.id).off("touchend.scroller"+this.id).off("mousemove.scroller"+this.id).off("mouseup.scroller"+this.id).off("resize.scroller"+this.id)},getSoureHeight:function(){var e;return e=0,this.$el.children().each(function(){return e+=t(this).outerHeight()}),e},getSoureWidth:function(){var e;return e=0,this.$el.children().each(function(){return e+=t(this).outerWidth()}),e},watch:function(){var t,e,i,n;return t=this.$container[0],i=!1,n=!1,e=!1,this.on("touchend",function(t){return function(e){var i,n;return i=e.e,n=e.vals,n.top+t.size.height>t.soureSize.height?t.$el.trigger("scrollend",i,t):n.top<20?t.$el.trigger("scrollstart",i,t):void 0}}(this)),t.addEventListener("touchstart",function(t){return function(i){return e=!0,i.target.tagName.match(/input|textarea|select/i)?void 0:(n=!0,t.scroller.doTouchStart(i.touches,i.timeStamp),!1)}}(this),!1),r.on("touchmove.scroller"+this.id,function(t){return function(e){var i;return i=e.originalEvent,t.scroller.doTouchMove(i.touches,i.timeStamp,i.scale||1),n?i.preventDefault():void 0}}(this)),r.on("touchend.scroller"+this.id,function(t){return function(i){var r;e=!0,n=!1,r=i.originalEvent,t.scroller.doTouchEnd(r.timeStamp),t.emit("touchend",{e:r,vals:t.scroller.getValues()})}}(this)),t.addEventListener("mousedown",function(t){return function(n){return e||n.target.tagName.match(/input|textarea|select/i)?void 0:(t.scroller.doTouchStart([{pageX:n.pageX,pageY:n.pageY}],n.timeStamp),i=!0)}}(this),!1),r.on("mousemove.scroller"+this.id,function(t){return function(n){var r;if(!e&&(r=n.originalEvent,!1!==i))return t.scroller.doTouchStart([{pageX:r.pageX,pageY:r.pageY}],r.timeStamp),i=!0,r.preventDefault()}}(this)),r.on("mouseup.scroller"+this.id,function(t){return function(n){var r;if(!e&&(r=n.originalEvent,!1!==i))return t.scroller.doTouchEnd(r.timeStamp),t.emit("touchend",{e:r,vals:t.scroller.getValues()}),i=!1}}(this)),r.on("resize.scroller"+this.id,function(t){return function(){return t.resize()}}(this))},resize:function(){var t,e,i,n,o,s,a,l;return e=this.$container[0],i=this.$el[0],o=e.getBoundingClientRect(),this.scroller.setPosition(o.left+e.clientLeft,o.top+e.clientTop),l=this.width||e.clientWidth,n=this.height||e.clientHeight,a=i.offsetWidth,s=i.offsetHeight,this.scrollingY&&0===this.height&&(n=r.outerHeight()-o.top),this.scrollingY&&n>s&&(s=this.getSoureHeight(),n>s&&(s=n+80)),this.scrollingX&&0===this.width&&(t=this.getSoureWidth()+4,t>a&&(a=t),n=s),this.$container.css({width:l||"100%",height:n||"100%"}),this.soureSize={width:a,height:s},this.size={width:this.$container.width(),height:this.$container.height()},this.scrollingY&&(s+=40),this.scroller.setDimensions(l,n,a,s)}}))})}.call(this);
//# sourceMappingURL=mcore.all.min.js.map